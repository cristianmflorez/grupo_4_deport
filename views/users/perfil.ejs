<!DOCTYPE html>
<html lang="en">
	<%- include('./../partials/head') %>
	<body>
		<%- include('./../partials/header') %> <%- include('./../partials/nav') %>

		<main class="container">
			<h2 class="p-3 text-center">Perfil</h2>
			<form action="/users/perfil/<%= locals.userLogged.id %>?_method=put" method="post" enctype="multipart/form-data">
				<% if (locals.userLogged) { %>
					<div class="mb-3 text-center">
						<img src="/imagenes/users/<%= locals.userLogged.img %>" alt="imagen de perfil" class="img-thumbnail w-25 h-25">
					</div>
					<div class="mb-3 w-25 mx-auto">
						<label for="avatar" class="form-label text-primary">
							<strong>Imagen (opcional)</strong>
						</label>
						<input
							id="avatar"
							type="file"
							name="avatar"
							class="form-control"
							aria-label="file example"
						/>
						<% if (locals.errors && errors.avatar) { %>
							<p style="color: red">
								<%= errors.avatar.msg %> 
							</p>
						<% } %>
					</div>
				<% } %>

                <div class="mb-3">
					<label for="nombre" class="form-label text-primary"
						><strong>Nombre completo</strong></label
					>
					<input
						type="text"
						class="form-control <%= (locals.errors && errors.nombre) ? 'is-invalid' : null %>"
						id="nombre"
                        <% if (locals.userLogged) { %>
                            value="<%= locals.userLogged.name %> "
                        <% } else { %>  
                            value="<%= locals.oldData && oldData.nombre ? oldData.nombre : null %>"
                        <% } %>
						name="nombre"
					/>
					<% if (locals.errors && errors.nombre) { %>
						<p style="color: red">
							<%= errors.nombre.msg %> 
						</p>
					<% } %>
				</div>

				<div class="mb-3">
					<label for="correo" class="form-label text-primary"
						><strong>Correo electrónico</strong></label
					>
					<input
						type="text"
						class="form-control <%= (locals.errors && errors.correo) ? 'is-invalid' : null %>"
						id="correo"
                        <% if (locals.userLogged) { %>
                            value="<%= locals.userLogged.email %> "
                        <% } else { %>  
						    value="<%= locals.oldData && oldData.correo ? oldData.correo : null %>"
                        <% } %>
                        name="correo"
						required
					/>
					<% if (locals.errors && errors.correo) { %>
						<p style="color: red">
							<%= errors.correo.msg %> 
						</p>
					<% } %>
				</div>

				<div class="mb-3">
					<label for="telefono" class="form-label text-primary"
						><strong>Teléfono</strong></label
					>
					<input
						type="tel"
						class="form-control <%= (locals.errors && errors.telefono) ? 'is-invalid' : null %>"
						id="telefono"
                        <% if (locals.userLogged) { %>
                            value="<%= locals.userLogged.tel %> "
                        <% } else { %>
						    value="<%= locals.oldData && oldData.telefono ? oldData.telefono : null %>"
                        <% } %> 
                        name="telefono"
					/>
					<% if (locals.errors && errors.telefono) { %>
						<p style="color: red">
							<%= errors.telefono.msg %> 
						</p>
					<% } %>
				</div>

				<div class="mb-3">
					<label for="direccion" class="form-label text-primary"
						><strong>Dirección</strong></label
					>
					<input
						type="text"
						class="form-control <%= (locals.errors && errors.direccion) ? 'is-invalid' : null %>"
						id="direccion"
						minlength="4"
                        <% if (locals.userLogged) { %>
                            value="<%= locals.userLogged.address %> "
                        <% } else { %>
						    value="<%= locals.oldData && oldData.direccion ? oldData.direccion : null %>"
                        <% } %> 
                        name="direccion"
					/>
					<% if (locals.errors && errors.direccion) { %>
						<p style="color: red">
							<%= errors.direccion.msg %> 
						</p>
					<% } %>
				</div>

                <div class="mb-3">
					<label for="correo" class="form-label text-primary"
						><strong>País</strong></label
					>
					<select
						class="form-select <%= (locals.errors && errors.pais) ? 'is-invalid' : null %>"
						aria-label="Default select example"
						name="pais"
					>
						<option disabled>Tu ubicación</option>
						<option value="Argentina" <%= locals.userLogged.country == "Argentina"? "selected" : "" %> >Argentina</option>
						<option value="Bolivia" <%= locals.userLogged.country == "Bolivia"? "selected" : "" %> >Bolivia</option>
						<option value="Brazil" <%= locals.userLogged.country == "Brazil"? "selected" : "" %> >Brasil</option>
						<option value="Chile" <%= locals.userLogged.country == "Chile"? "selected" : "" %> >Chile</option>
						<option value="Colombia" <%= locals.userLogged.country == "Colombia"? "selected" : "" %> >Colombia</option>
						<option value="Ecuador" <%= locals.userLogged.country == "Ecuador"? "selected" : "" %> >Ecuador</option>
						<option value="Paraguay" <%= locals.userLogged.country == "Paraguay"? "selected" : "" %> >Paraguay</option>
						<option value="Peru" <%= locals.userLogged.country == "Peru"? "selected" : "" %> >Perú</option>
						<option value="Uruguay" <%= locals.userLogged.country == "Uruguay"? "selected" : "" %> >Uruguay</option>
						<option value="Venezuela" <%= locals.userLogged.country == "Venezuela"? "selected" : "" %> >Venezuela</option>
					</select>
				</div>
                
				<div class="mb-3 d-flex justify-content-between">
					<a href="/" class="btn btn-secondary col-4">Volver</a>
					<button type="submit" class="btn btn-secondary col-4">Guardar</button>
				</div>
			</form>
			<form
				action="/users/delete/<%= locals.userLogged.id %>?_method=delete"
				method="post"
				class="mb-3 d-flex justify-content-end"
			>
				<button type="submit" class="btn btn-danger col-4">
					Eliminar cuenta
				</button>
			</form>
		</main>

		<%- include('./../partials/footer') %>
	</body>
</html>
